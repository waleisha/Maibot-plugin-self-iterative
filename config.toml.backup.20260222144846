# MaiBot 自我迭代插件配置文件 v2.2
# 修复版 - 简化的LLM配置

[plugin]
config_version = "2.2.0"
enabled = true

[security]
# 超级管理员QQ号列表
admin_qqs = [123456789]

# 允许读取的路径白名单（相对于MaiBot根目录）
allowed_read_paths = ["src", "plugins", "maibot_plugin_self_iterative"]

# 允许修改的路径白名单（相对于MaiBot根目录）
allowed_write_paths = ["src", "plugins", "maibot_plugin_self_iterative"]

# 禁止访问的文件模式（正则表达式）
forbidden_patterns = [
    ".*\\.env.*",
    ".*token.*",
    ".*password.*",
    ".*secret.*",
    ".*credential.*",
    ".*api_key.*",
    ".*private.*",
    ".*config.*"
]

# 允许的终端命令
allowed_commands = [
    "pip", "python", "python3", "git",
    "ls", "cat", "echo", "mkdir", "touch",
    "cp", "mv", "find", "grep", "head", "tail",
    "wc", "diff", "stat", "pwd", "cd"
]

# 禁止的终端命令
forbidden_commands = [
    "rm -rf /", "rm -rf /*", "dd if=/dev/zero",
    ":(){ :|:& };:", "> /dev/sda", "mkfs", "fdisk",
    "format", "del /f /s /q", "rd /s /q",
    "powershell -Command", "Invoke-Expression", "iex",
    "wget.*|.*sh", "curl.*|.*sh"
]

[iteration]
# 影子工作区路径（相对于插件目录）
shadow_workspace_path = "storage/.shadow"

# 备份存储路径（相对于插件目录）
backup_path = "storage/.backups"

# 最大备份数量
max_backups = 50

# 是否启用语法检查
enable_syntax_check = true

# 是否启用差异报告
enable_diff_report = true

# 审核超时时间（秒）
approval_timeout = 300

# 重启前等待时间（秒）
restart_delay = 3

# ============================================
# LLM 配置 - 简化的统一配置 (v2.2)
# ============================================
[llm]
# 是否启用独立LLM（默认使用框架LLM）
# 设置为 true 时，使用下面配置的独立LLM
# 设置为 false 时，使用MaiBot框架的默认LLM
enabled = false

# API基础URL（OpenAI兼容格式）
# 支持:
# - OpenAI: https://api.openai.com/v1
# - Claude (OpenAI兼容): https://api.anthropic.com/v1
# - Gemini (OpenAI兼容): https://generativelanguage.googleapis.com/v1beta/openai
# - Moonshot: https://api.moonshot.cn/v1
# - DeepSeek: https://api.deepseek.com/v1
# - 其他OpenAI兼容的API
base_url = "https://api.openai.com/v1"

# API密钥
# 如果为空，会尝试从环境变量读取 (OPENAI_API_KEY, ANTHROPIC_API_KEY, etc.)
api_key = ""

# 模型名称
# OpenAI: gpt-4o, gpt-4o-mini, gpt-3.5-turbo
# Claude: claude-3-5-sonnet-20241022, claude-3-opus-20240229
# Gemini: gemini-2.0-flash-exp, gemini-1.5-pro
# Moonshot: kimi-latest, kimi-k2-0711-preview
# DeepSeek: deepseek-coder, deepseek-chat
model = "gpt-4o"

# 生成温度(0-1)，越低越保守
temperature = 0.3

# 最大生成token数
max_tokens = 4096

[features]
# 是否启用LLM工具注入（核心功能）
enable_tool_inject = true

# 是否启用自动备份
enable_auto_backup = true

# 是否启用回滚功能
enable_rollback = true

# 是否启用弱命令（自然语言触发迭代）
enable_weak_command = true

[logging]
# 日志级别
level = "INFO"

# 是否记录工具调用
log_tool_calls = true

# 是否记录文件操作
log_file_operations = true
